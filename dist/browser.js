!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):e.ReactOpiumSelect=t(e.React)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var n=function(n){function o(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,t)),i=t.settings||{},r=i.maxItems,s=i.style,a=void 0===s?{}:s,l=a.padding,c=void 0===l?"10px 14px":l,d=a.borderWidth,u=void 0===d?0:d,p=a.borderRadius,h=void 0===p?0:p,f=a.borderColor,m=void 0===f?"#5D5E5F":f,v=a.background,y=void 0===v?"#f1f2f3":v,b=a.textColor,g=void 0===b?"#3a3a3d":b;return n.state={isOpen:!1,shrink:!1,selected:null,itemHeight:null,midItemCount:null,maxItems:r,padding:c,borderWidth:u,border:u?u+"px solid "+m:0,bgColor:y,textColor:g,radius:0===h&&u?1:h},n.handleClick=n.handleClick.bind(n),n.handleKeyDown=n.handleKeyDown.bind(n),n.toggleDropdown=n.toggleDropdown.bind(n),n.container=e.createRef(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(o,e.PureComponent),t(o,[{key:"componentDidMount",value:function(){var e=this.props.options;(void 0===e?[]:e).length&&(document.addEventListener("mousedown",this.handleClick,!1),this._setInitialValue(),this._setDimensions())}},{key:"componentWillReceiveProps",value:function(e){e.selectedValue!==this.props.selectedValue&&this.setState({selected:e.selectedValue})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClick,!1)}},{key:"handleClick",value:function(e){!this.container.current.contains(e.target)&&this.state.isOpen&&this.hideDropdown()}},{key:"hideDropdown",value:function(){var e=this;this.setState({isOpen:!1});var t=this.props.animateOnSelect;(void 0===t||t)&&(this.setState({shrink:!0}),setTimeout(function(){e.setState({shrink:!1})},200))}},{key:"toggleDropdown",value:function(){var e=this,t=this.props,n=t.options,o=t.forceDirection,i=n.length,r=this.state,s=r.isOpen,a=r.itemHeight,l=r.borderWidth,c=r.midItemCount,d=r.maxItems,u=void 0===d?i:d,p=r.selected;if(s)this.hideDropdown();else{var h=u>i?i:u,f=0,m=0,v=0;if(p&&!o){var y=n.findIndex(function(e){return e.value===p}),b=y+1;if(b<=c)v=(h-b)*a,f=m=y*a+l;else if(i-b>=c){v=m=c*a,f=m-(Number.isInteger(h/2)?.5:0)*a}else{var g=i-y;v=(g-1)*a,f=m=(h-g)*a-l}}else"up"===o?f=(m=h*a)+4:(v=h*a,f=-(a+4));p&&setTimeout(function(){e.selectedItem.scrollIntoView({block:"center"})}),this.setState({isOpen:!0,topOffset:-f});var k=this.container.current.lastChild.style;k.top=-f+"px",k.clipPath="inset("+m+"px -1px "+v+"px 0)",k.opacity=0,setTimeout(function(){k.clipPath="inset(0px -1px 0px 0)",k.opacity=1})}}},{key:"handleKeyDown",value:function(e){var t=this.state.selected,n=this.props.options,o=n.findIndex(function(e){return e.value===t});switch(e.keyCode){case 13:this.toggleDropdown();break;case 27:this.hideDropdown();break;case 38:o>0&&(this.setState({selected:n[o-1].value}),this.selectedItem.scrollIntoView({block:"center"}));break;case 40:o<n.length-1&&(this.setState({selected:n[o+1].value}),this.selectedItem.scrollIntoView({block:"center"}))}}},{key:"selectItem",value:function(e){this.setState({selected:e}),this.state.selected!==e&&this.props.onChange(e),this.hideDropdown()}},{key:"_setDimensions",value:function(){var e=this;window.onload=function(){var t=e.props,n=t.options,o=t.forceDirection,i=e.state,r=i.maxItems,s=void 0===r?n.length:r,a=i.borderWidth,l=e.container.current,c=l.offsetHeight-2*a;if(e.setState({itemHeight:c,midItemCount:Math.floor(s/2)}),l.lastChild.style.setProperty("--maxHeight",c*s+"px"),!o){var d=s*c,u=l.offsetTop,p=window.innerHeight-(u+c);u>=d&&p>=d||(p>=d?e.setState({forceDirection:"down"}):u>=d&&e.setState({forceDirection:"up"}))}}}},{key:"_setInitialValue",value:function(){var e=this.props.selectedValue,t=(this.props.settings||{}).placeholder,n=this.container.current.lastChild.style,o=this.state.textColor;n.setProperty("--hover",""+this._addtransparency(o,12)),n.setProperty("--scrollbar",""+this._addtransparency(o,20)),n.setProperty("--scrollbarThumb",""+this._addtransparency(o,30)),t&&!e||this.setState({selected:e||this.props.options[0].value})}},{key:"_getLabelByValue",value:function(e){if(!e){var t=this.props.settings;return t&&t.placeholder}return this.props.options.find(function(t){return t.value===e}).label}},{key:"_addtransparency",value:function(e,t){return/#/.test(e),3===(e=e.replace("#","")).length&&(e=e.repeat(2)),"rgba("+parseInt(e.substring(0,2),16)+", "+parseInt(e.substring(2,4),16)+", "+parseInt(e.substring(4,6),16)+", "+t/100+")"}},{key:"render",value:function(){var t=this,n=this.props.options,o=void 0===n?[]:n;if(!o.length)return"Err: No options found.";var i=this.state,r=i.padding,s=i.border,a=i.borderWidth,l=i.bgColor,c=i.textColor,d=i.radius,u=i.selected,p=i.isOpen,h=i.shrink;return e.createElement("div",{tabIndex:"0",className:"opm-container "+(h?"opm-shrink":""),style:{background:l,color:c,border:s,borderRadius:d},onKeyDown:this.handleKeyDown,ref:this.container},e.createElement("span",{className:"opm-selected",style:{padding:r},onClick:this.toggleDropdown},e.createElement("span",{className:"opm-selected-text "+(u?"":"opm-placeholder")},this._getLabelByValue(u)),e.createElement("svg",{width:"9",height:"14",viewBox:"0 0 9 14"},e.createElement("g",{fillRule:"nonzero",fill:c,opacity:"0.8",stroke:"none",strokeWidth:"1"},e.createElement("path",{d:"M.829 4.997a.602.602 0 0 0 .426-.17l3.221-3.355 3.292 3.356c.237.241.616.241.83 0 .236-.242.236-.628 0-.845L4.877.193C4.762.073 4.619 0 4.454.024a.674.674 0 0 0-.427.17L.403 3.982c-.237.241-.237.627 0 .845.118.12.26.169.426.169zM.403 9.993L4.12 13.76c.118.12.26.169.426.169a.674.674 0 0 0 .427-.17L8.62 9.97c.237-.241.237-.628 0-.845-.237-.241-.616-.241-.829 0L4.524 12.48 1.232 9.124c-.237-.241-.616-.241-.83 0a.62.62 0 0 0 0 .87z"})))),e.createElement("ul",{className:"opm-list "+(p?"":"opm-hidden"),style:{left:-a,width:"calc(100% + "+2*a+"px)"}},o.map(function(n){return e.createElement("li",{key:n.value,className:"opm-item",style:{padding:r},ref:function(e){u===n.value&&(t.selectedItem=e)},onClick:t.selectItem.bind(t,n.value)},n.label,u===n.value&&e.createElement("svg",{width:"11",height:"8",viewBox:"0 0 11 8"},e.createElement("path",{d:"M1.422 4.341a.83.83 0 0 0-1.128-.083.734.734 0 0 0-.088 1.071l2.122 2.353.608-.494-.609.495a.832.832 0 0 0 1.194.026l7.104-6.282a.734.734 0 0 0 .04-1.075.83.83 0 0 0-1.13-.038L3 6.092l-1.58-1.75z",fillRule:"nonzero",fill:c,stroke:"none",strokeWidth:"1",opacity:"0.85"})))})))}}]),o}();return n.defaultProps={onChange:function(){}},n});
