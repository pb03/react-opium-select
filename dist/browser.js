!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):e.ReactOpiumSelect=t(e.React)}(this,function(e){"use strict";var t="default"in e?e.default:e,n=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var o=function(o){function i(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return n.state={isOpen:!1,shrink:!1,selected:null,itemHeight:null,midItemCount:null},n.handleClick=n.handleClick.bind(n),n.handleKeyDown=n.handleKeyDown.bind(n),n.toggleDropdown=n.toggleDropdown.bind(n),n.container=t.createRef(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e.PureComponent),n(i,[{key:"componentDidMount",value:function(){this.props.options.length&&(document.addEventListener("mousedown",this.handleClick,!1),this._setInitialValue(),this._setDimensions())}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClick,!1)}},{key:"handleClick",value:function(e){!this.container.current.contains(e.target)&&this.state.isOpen&&this.hideDropdown()}},{key:"hideDropdown",value:function(){var e=this;this.setState({isOpen:!1,shrink:!0}),setTimeout(function(){e.setState({shrink:!1})},200)}},{key:"toggleDropdown",value:function(){var e=this,t=this.props,n=t.options,o=t.forceDirection,i=t.settings,r=i.maxItems,s=void 0===r?n.length:r,a=i.style.borderWidth,l=void 0===a?0:a,c=this.state,d=c.isOpen,u=c.itemHeight,p=c.midItemCount,h=c.selected,f=n.length;if(d)this.hideDropdown();else{var m=s>f?f:s,v=0,y=0,g=0;if(h&&!o){var b=n.findIndex(function(e){return e.value===h}),k=b+1;if(k<=p)g=(m-k)*u,v=y=b*u+l;else if(f-k>=p){g=y=p*u,v=y-(Number.isInteger(m/2)?.5:0)*u}else{var w=f-b;g=(w-1)*u,v=y=(m-w)*u-l}}else"up"===o?v=(y=m*u)+4:(g=m*u,v=-(u+4));h&&setTimeout(function(){e.selectedItem.scrollIntoView({block:"center"})}),this.setState({isOpen:!0,topOffset:-v});var x=this.container.current.lastChild.style;x.top=-v+"px",x.clipPath="inset("+y+"px -1px "+g+"px 0)",x.opacity=0,setTimeout(function(){x.clipPath="inset(0px -1px 0px 0)",x.opacity=1})}}},{key:"handleKeyDown",value:function(e){var t=this.state.selected,n=this.props.options,o=n.findIndex(function(e){return e.value===t});switch(e.keyCode){case 13:this.toggleDropdown();break;case 27:this.hideDropdown();break;case 38:o>0&&(this.setState({selected:n[o-1].value}),this.selectedItem.scrollIntoView({block:"center"}));break;case 40:o<n.length-1&&(this.setState({selected:n[o+1].value}),this.selectedItem.scrollIntoView({block:"center"}))}}},{key:"selectItem",value:function(e){this.setState({selected:e}),this.state.selected!==e&&this.props.onChange(e),this.hideDropdown()}},{key:"_setDimensions",value:function(){var e=this;window.onload=function(){var t=e.props,n=t.options,o=t.forceDirection,i=t.settings,r=i.maxItems,s=void 0===r?n.length:r,a=i.style.borderWidth,l=void 0===a?0:a,c=e.container.current,d=c.offsetHeight-2*l;if(e.setState({itemHeight:d,midItemCount:Math.floor(s/2)}),c.lastChild.style.setProperty("--maxHeight",d*s+"px"),!o){var u=s*d,p=c.offsetTop,h=window.innerHeight-(p+d);p>=u&&h>=u||(h>=u?e.setState({forceDirection:"down"}):p>=u&&e.setState({forceDirection:"up"}))}}}},{key:"_setInitialValue",value:function(){var e=this.props.selectedValue,t=this.props.settings,n=t.placeholder,o=t.style.textColor,i=void 0===o?"#3a3a3d":o,r=this.container.current.lastChild.style;r.setProperty("--hover",""+this._addtransparency(i,12)),r.setProperty("--scrollbar",""+this._addtransparency(i,20)),r.setProperty("--scrollbarThumb",""+this._addtransparency(i,30)),n&&!e||this.setState({selected:e||this.props.options[0].value})}},{key:"_getLabelByValue",value:function(e){if(!e){var t=this.props.settings;return t&&t.placeholder}return this.props.options.find(function(t){return t.value===e}).label}},{key:"_addtransparency",value:function(e,t){return/#/.test(e),3===(e=e.replace("#","")).length&&(e=e.repeat(2)),"rgba("+parseInt(e.substring(0,2),16)+", "+parseInt(e.substring(2,4),16)+", "+parseInt(e.substring(4,6),16)+", "+t/100+")"}},{key:"render",value:function(){var e=this,n=this.props,o=n.options,i=n.settings.style,r=i.padding,s=void 0===r?"10px 14px":r,a=i.borderRadius,l=void 0===a?0:a,c=i.background,d=void 0===c?"#f1f2f3":c,u=i.textColor,p=void 0===u?"#3a3a3d":u,h=i.borderWidth,f=void 0===h?0:h,m=i.borderColor,v=void 0===m?"#5d5e5f":m;if(!o.length)return"Err: No options found.";var y=this.state,g=y.selected,b=y.isOpen,k=y.shrink,w=f?f+"px solid "+v:0;return t.createElement("div",{tabIndex:"0",className:"opm-container "+(k?"opm-shrink":""),style:{background:d,color:p,border:w,borderRadius:l},onKeyDown:this.handleKeyDown,ref:this.container},t.createElement("span",{className:"opm-selected",style:{padding:s},onClick:this.toggleDropdown},t.createElement("span",{className:"opm-selected-text "+(g?"":"opm-placeholder")},this._getLabelByValue(g)),t.createElement("svg",{width:"9",height:"14",viewBox:"0 0 9 14"},t.createElement("g",{fillRule:"nonzero",fill:p,opacity:"0.8",stroke:"none",strokeWidth:"1"},t.createElement("path",{d:"M.829 4.997a.602.602 0 0 0 .426-.17l3.221-3.355 3.292 3.356c.237.241.616.241.83 0 .236-.242.236-.628 0-.845L4.877.193C4.762.073 4.619 0 4.454.024a.674.674 0 0 0-.427.17L.403 3.982c-.237.241-.237.627 0 .845.118.12.26.169.426.169zM.403 9.993L4.12 13.76c.118.12.26.169.426.169a.674.674 0 0 0 .427-.17L8.62 9.97c.237-.241.237-.628 0-.845-.237-.241-.616-.241-.829 0L4.524 12.48 1.232 9.124c-.237-.241-.616-.241-.83 0a.62.62 0 0 0 0 .87z"})))),t.createElement("ul",{className:"opm-list "+(b?"":"opm-hidden"),style:{left:-f,width:"calc(100% + "+2*f+"px)"}},o.map(function(n){return t.createElement("li",{key:n.value,className:"opm-item",style:{padding:s},ref:function(t){g===n.value&&(e.selectedItem=t)},onClick:e.selectItem.bind(e,n.value)},n.label,g===n.value&&t.createElement("svg",{width:"11",height:"8",viewBox:"0 0 11 8"},t.createElement("path",{d:"M1.422 4.341a.83.83 0 0 0-1.128-.083.734.734 0 0 0-.088 1.071l2.122 2.353.608-.494-.609.495a.832.832 0 0 0 1.194.026l7.104-6.282a.734.734 0 0 0 .04-1.075.83.83 0 0 0-1.13-.038L3 6.092l-1.58-1.75z",fillRule:"nonzero",fill:p,stroke:"none",strokeWidth:"1",opacity:"0.85"})))})))}}]),i}();return o.defaultProps={options:[],settings:{},onChange:function(){}},o});
